{% extends 'base.html' %}

{% block title %} Edit Job {% endblock %}

{% block csslink %}
<link rel="stylesheet" href="{{ url_for('static', path='css/applicantdetail.css') }}">
{% endblock %}

{% block content %}
<div class="col-md-9 col-lg-10">
    <!-- Applicant Header -->
    <div class="applicant-header rounded">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-2 text-center">
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face" 
                         alt="Applicant Photo" class="applicant-avatar">
                </div>
                <div class="col-md-7">
                    <h2 class="mb-2">{{applicant.user.name}}</h2>
                    <p class="mb-1 opacity-75">{{applicant.user.email}}</p>
                    <p class="mb-2 opacity-75">Applied for: {{applicant.job.title}}</p>
                    <span class="status-badge status-pending"> {{applicant.status}} </span>
                </div>
                <div class="col-md-3 text-end">
                    <p class="mb-1 opacity-75">Applied on</p>
                    <h6 class="mb-0">{{applicant.job.posted_on}}</h6>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- Personal Information -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-user me-2"></i>Personal Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="info-item">
                                    <i class="fas fa-user"></i>
                                    <div>
                                        <strong>Full Name:</strong><br>
                                        <span class="text-muted">{{applicant.user.name}}</span>
                                    </div>
                                </div>
                               
                                <div class="info-item">
                                    <i class="fas fa-envelope"></i>
                                    <div>
                                        <strong>Email:</strong><br>
                                        <span class="text-muted">{{applicant.user.email}}</span>
                                    </div>
                                </div>
                               
                                <div class="info-item">
                                    <i class="fas fa-phone"></i>
                                    <div>
                                        <strong>Phone Number:</strong><br>
                                        <span class="text-muted">{{applicant.number}}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <div>
                                        <strong>Address:</strong><br>
                                        <span class="text-muted">{{applicant.address}}</span>
                                    </div>
                                </div>
                               
                                <div class="info-item">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <strong>Application Time:</strong><br>
                                        <span class="text-muted">{{applicant.applied_time.strftime("%b %d, %Y")}}</span>
                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Job Applied For -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-briefcase me-2"></i>Job Applied For</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h6 class="text-primary mb-2">{{applicant.job.title}}</h6>
                                <p class="text-muted mb-2">{{applicant.job.company}}</p>
                                <p class="mb-2 mt-4"><strong>Salary:</strong>Rs. {{applicant.job.salary}}</p>
                                <p class="mb-2"><strong>Seniority Level:</strong> {{applicant.job.seniority_level}} </p>
                            </div>
                            <div class="col-md-4 text-end">
                                <p class="text-muted mb-1">Job Posted</p>
                                <h6 class="mb-3"> {{applicant.job.posted_on}} </h6>
                                <a href=" {{url_for('get_job_detail', job_id=applicant.job.id)}} " class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-eye me-1"></i>View Job Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resume -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-file-pdf me-2"></i>Resume</h5>
                    </div>
                    <div class="card-body">
                        <div class="resume-preview">
                            <i class="fas fa-file-pdf fa-3x text-primary mb-3"></i>
                            <h6 class="mb-2">{{applicant.user.name}} resume</h6>
                            <p class="text-muted mb-3">Uploaded on {{applicant.applied_time.strftime("%b %d, %Y")}} </p>
                            <div class="d-flex justify-content-center gap-2">
                                <a href="{{applicant.resume}}" class="btn btn-primary">
                                    <i class="fas fa-download me-1"></i>See Resume
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Sidebar -->
            <div class="col-lg-4">
                <div class="action-buttons">

                    <!-- Application Status -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Applicant Assessment</h5>
                        </div>
                        <div class="card-body">
                            <p>Click the following button to get the applicant review.</p>
                            <a class="btn btn-primary" href="{{url_for('applicant_reviewer', applicant_id=applicant.id)}}">Get AI Review</a>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                            <i class="fas fa-info-circle me-2"></i>Application Status
                            </h5>
                        </div>

                        <form id="status-form"
                                method="post"
                                action="{{ url_for('applicant_status', applicant_id=applicant.id) }}"
                                class="card-body">

                            <div class="mb-3">
                            <label for="status-select" class="form-label">Current Status</label>
                            <select id="status-select" class="form-select" name="status" required>
                                <option value="pending"  {% if applicant.status == 'pending' %}selected{% endif %}>Pending Review</option>
                                <option value="rejected" {% if applicant.status == 'rejected' %}selected{% endif %}>Rejected</option>
                                <option value="accepted" {% if applicant.status == 'accepted' %}selected{% endif %}>Accepted</option>
                            </select>
                            </div>

                            <button class="btn btn-primary w-100" type="submit">
                            <i class="fas fa-save me-1"></i>Update Status
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap Interview Modal -->
<div class="modal fade" id="interviewModal" tabindex="-1" aria-labelledby="interviewModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content rounded-4 shadow">
      <div class="modal-header">
        <h5 class="modal-title" id="interviewModalLabel">Schedule Interview</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <form id="interview-form">
          <div class="mb-3">
            <label for="interview-date" class="form-label">Interview Date</label>
            <input type="date" id="interview-date" name="interview_date" class="form-control" required>
          </div>

          <div class="mb-3">
            <label for="interview-time" class="form-label">Interview Time</label>
            <input type="time" id="interview-time" name="interview_time" class="form-control" required>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" id="confirm-modal" class="btn btn-primary">Confirm</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}


{% block jslink %}
<script src="{{ url_for('static', path='js/applicantdetail.js') }}"></script>
{% endblock %}